<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mon Carnet d'√âquitation üêé</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .horse-card.active { border: 3px solid #6366f1; background-color: #f5f3ff; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        body { background-color: #fdfbf7; padding-bottom: 80px; }
    </style>
</head>
<body class="p-4 max-w-md mx-auto">

    <div id="home" class="tab-content active">
        <header class="text-center mb-6">
            <h1 class="text-2xl font-bold text-gray-800">Hello Cavali√®re ! üëã</h1>
            <div class="text-sm text-gray-600 mt-2 bg-white p-2 rounded-lg shadow-sm">
                üìç P√¥le Hippique de Montlaur : <span>14¬∞C - Beau temps ‚òÄÔ∏è</span>
            </div>
        </header>

        <div class="bg-indigo-600 text-white p-4 rounded-2xl shadow-lg mb-6 text-center">
            <p class="text-xs uppercase tracking-widest opacity-80">Prochain galop dans</p>
            <div id="countdown" class="text-2xl font-black py-1">--j --h --m</div>
        </div>

        <section class="mb-6">
            <h2 class="font-bold mb-3 text-gray-700">Qui est ta monture aujourd'hui ?</h2>
            <div class="flex overflow-x-auto space-x-3 pb-2" id="horse-list"></div>
        </section>

        <section class="bg-white p-5 rounded-2xl shadow-sm border border-gray-100 mb-6">
            <h2 class="font-bold mb-4 text-gray-700 italic">Rituel de pr√©paration</h2>
            <div class="space-y-3" id="checklist">
                <label class="flex items-center space-x-3 text-gray-600"><input type="checkbox" class="w-5 h-5"> <span>C√¢lin de bonjour</span></label>
                <label class="flex items-center space-x-3 text-gray-600"><input type="checkbox" class="w-5 h-5"> <span>Pansage complet</span></label>
                <label class="flex items-center space-x-3 text-gray-600"><input type="checkbox" class="w-5 h-5"> <span>Curer les pieds</span></label>
                <label class="flex items-center space-x-3 text-gray-600 font-bold text-indigo-600">
                    <input type="checkbox" class="w-5 h-5" id="confirm-ride"> <span>Pr√™te pour le d√©part !</span>
                </label>
            </div>
        </section>

        <button onclick="sendAlert()" class="w-full bg-orange-500 text-white font-bold py-4 rounded-2xl shadow-lg flex items-center justify-center space-x-3 transition-transform active:scale-95">
            <span>ü•ï SIGNAL CAROTTES</span>
        </button>
    </div>

    <div id="stats" class="tab-content">
        <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">Tes Statistiques üìä</h2>
        <div id="stats-container" class="space-y-4">
            </div>
        <p class="text-xs text-center text-gray-400 mt-10 italic">Tes montures depuis le d√©but de ton carnet.</p>
    </div>

    <nav class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 flex justify-around p-3 shadow-2xl">
        <button onclick="showTab('home')" class="flex flex-col items-center text-indigo-600">
            <i class="fas fa-home text-xl"></i><span class="text-xs">Accueil</span>
        </button>
        <button onclick="showTab('stats')" class="flex flex-col items-center text-gray-400">
            <i class="fas fa-chart-pie text-xl"></i><span class="text-xs">Stats</span>
        </button>
    </nav>

    <script>
        const horses = [
            {name: "Diva", icon: "‚≠ê"}, {name: "Bol√©ro", icon: "üéª"}, {name: "Frontera", icon: "üêé"}, 
            {name: "Jumper", icon: "ü¶ò"}, {name: "Noname", icon: "‚ùì"}, {name: "Bandolera", icon: "üíÉ"},
            {name: "Hacienda", icon: "üè°"}, {name: "Moon", icon: "üåô"}, {name: "Guappa", icon: "üéÄ"}, 
            {name: "Koda", icon: "üêª"}, {name: "Rififi", icon: "üå™Ô∏è"}
        ];

        let selectedHorse = "";

        // Initialisation de la liste des chevaux
        const horseList = document.getElementById('horse-list');
        horses.forEach(h => {
            const div = document.createElement('div');
            div.className = "horse-card flex-shrink-0 bg-white p-4 rounded-xl shadow-sm text-center min-w-[90px] border cursor-pointer";
            div.innerHTML = `<div class="text-2xl">${h.icon}</div><div class="font-bold text-sm">${h.name}</div>`;
            div.onclick = () => {
                document.querySelectorAll('.horse-card').forEach(c => c.classList.remove('active'));
                div.classList.add('active');
                selectedHorse = h.name;
            };
            horseList.appendChild(div);
        });

        // Gestion des onglets
        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            if(tabId === 'stats') updateStatsUI();
        }

        // Enregistrer une s√©ance
        document.getElementById('confirm-ride').addEventListener('change', function() {
            if(this.checked && selectedHorse) {
                let stats = JSON.parse(localStorage.getItem('horseStats')) || {};
                stats[selectedHorse] = (stats[selectedHorse] || 0) + 1;
                localStorage.setItem('horseStats', JSON.stringify(stats));
                alert(`S√©ance avec ${selectedHorse} enregistr√©e ! üéâ`);
            } else if (!selectedHorse) {
                alert("Choisis d'abord ton cheval !");
                this.checked = false;
            }
        });

        // Mise √† jour de l'affichage des stats
        function updateStatsUI() {
            const stats = JSON.parse(localStorage.getItem('horseStats')) || {};
            const container = document.getElementById('stats-container');
            container.innerHTML = "";
            
            Object.entries(stats).sort((a,b) => b[1] - a[1]).forEach(([name, count]) => {
                const row = document.createElement('div');
                row.className = "flex justify-between items-center bg-white p-4 rounded-xl shadow-sm border-l-4 border-indigo-500";
                row.innerHTML = `<span class="font-bold">${name}</span> <span class="bg-indigo-100 text-indigo-700 px-3 py-1 rounded-full text-sm font-bold">${count} s√©ance(s)</span>`;
                container.appendChild(row);
            });
            if(Object.keys(stats).length === 0) container.innerHTML = "<p class='text-center text-gray-500'>Aucune s√©ance enregistr√©e pour le moment.</p>";
        }

        // Countdown Lun/Jeu 19h
        function updateCountdown() {
            const now = new Date();
            let next = new Date();
            const day = now.getDay();
            let daysToAdd = (day <= 1) ? (1 - day) : (day <= 4 ? 4 - day : 8 - day);
            if (daysToAdd === 0 && now.getHours() >= 19) daysToAdd = (day === 1 ? 3 : 4);
            next.setDate(now.getDate() + daysToAdd);
            next.setHours(19, 0, 0, 0);
            const diff = next - now;
            const d = Math.floor(diff / 86400000);
            const h = Math.floor((diff % 86400000) / 3600000);
            const m = Math.floor((diff % 3600000) / 60000);
            document.getElementById('countdown').innerText = `${d}j ${h}h ${m}m`;
        }
        setInterval(updateCountdown, 60000);
        updateCountdown();

        function sendAlert() {
            const text = encodeURIComponent(`Coucou ! S√©ance finie avec ${selectedHorse || "mon cheval"} √† Montlaur. On attend nos carottes ! ü•ïüêé`);
            window.location.href = `sms:0619972026?body=${text}`;
        }
    </script>
</body>
</html>
